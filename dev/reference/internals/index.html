<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · HallThruster.jl</title><meta name="title" content="Internals · HallThruster.jl"/><meta property="og:title" content="Internals · HallThruster.jl"/><meta property="twitter:title" content="Internals · HallThruster.jl"/><meta name="description" content="Documentation for HallThruster.jl."/><meta property="og:description" content="Documentation for HallThruster.jl."/><meta property="twitter:description" content="Documentation for HallThruster.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citation.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="HallThruster.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">HallThruster.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><a class="tocitem" href="../../NEWS/">Release notes</a></li><li><a class="tocitem" href="../../highlights/">Science highlights</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/simulation/">Run a simulation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/json/">Use JSON input and output</a></li><li><a class="tocitem" href="../../howto/python/">Run a simulation from python</a></li><li><a class="tocitem" href="../../howto/new_propellant/">Add a new propellant</a></li><li><a class="tocitem" href="../../howto/new_anom_model/">Implement an anomalous transport model</a></li><li><a class="tocitem" href="../../howto/coupling/">Couple HallThruster.jl to C or Fortran</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanation/physics/">Physics model</a></li><li><a class="tocitem" href="../../explanation/numerics/">Numerics</a></li><li><a class="tocitem" href="../../explanation/grid_generation/">Grid generation</a></li><li><a class="tocitem" href="../../explanation/timestepping/">Timestepping</a></li><li><a class="tocitem" href="../../explanation/verification/">Validation and verification</a></li><li><a class="tocitem" href="../../explanation/initialization/">Initialization</a></li><li><a class="tocitem" href="../../explanation/plume/">Quasi-1D plume model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../simparams/">Simulation parameters</a></li><li><a class="tocitem" href="../solution/">Solution</a></li><li><a class="tocitem" href="../postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../thrusters/">Thrusters</a></li><li><a class="tocitem" href="../propellants/">Propellants</a></li><li><a class="tocitem" href="../anomalous_transport/">Anomalous transport models</a></li><li><a class="tocitem" href="../wall_loss_models/">Wall loss models</a></li><li><a class="tocitem" href="../electron_thermal_conductivity/">Thermal conductivity models</a></li><li><a class="tocitem" href="../collisions/">Collisions and reactions</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Solution-procedure"><span>Solution procedure</span></a></li><li><a class="tocitem" href="#Data-structures"><span>Data structures</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/UM-PEPL/HallThruster.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/UM-PEPL/HallThruster.jl/blob/main/docs/src/reference/internals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><div class="admonition is-warning" id="Developer-information-2b1e471d407a5b56"><header class="admonition-header">Developer information<a class="admonition-anchor" href="#Developer-information-2b1e471d407a5b56" title="Permalink"></a></header><div class="admonition-body"><p>The internals are not considered part of the public API and are subject to change.</p></div></div><h2 id="Solution-procedure"><a class="docs-heading-anchor" href="#Solution-procedure">Solution procedure</a><a id="Solution-procedure-1"></a><a class="docs-heading-anchor-permalink" href="#Solution-procedure" title="Permalink"></a></h2><p>HallThruster.jl&#39;s solution procedure is summarized in the diagram below. At each timestep, we first advance the ions and neutrals, then compute the plasma density and ion current. From there, we solve Ohm&#39;s law to get the discharge current, plasma potential, and electric field. Finally, we advance the electron energy equation.</p><p><img src="../../assets/het_solution.svg" alt/></p><h2 id="Data-structures"><a class="docs-heading-anchor" href="#Data-structures">Data structures</a><a id="Data-structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-structures" title="Permalink"></a></h2><p>There are three main data structures to be aware of when developing for HallThruster.jl: the <code>FluidContainer</code>, the <code>cache</code>, and the <code>params</code>. A <code>FluidContainer</code> contains all information needed to step heavy species (neutrals and ions) through time. We create one of these per neutral and ion species present in the simulation, and treat them largely independently except for when computing chemical and electronic interactions between species. More information about this struct is available below.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="HallThruster.FluidContainer" href="#HallThruster.FluidContainer"><code>HallThruster.FluidContainer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct FluidContainer</code></pre><p>Struct containing necessary internal states and caches for solving the heavy species fluid equations and for interfacing with the electron solver.</p><p><strong>Fields</strong></p><ul><li><p><code>density::Vector{Float64}</code>: Mass density in kg/m^3</p></li><li><p><code>momentum::Vector{Float64}</code>: Momentum density in kg/m^2 s</p></li><li><p><code>dens_ddt::Vector{Float64}</code></p></li><li><p><code>mom_ddt::Vector{Float64}</code></p></li><li><p><code>dens_cache::Vector{Float64}</code></p></li><li><p><code>mom_cache::Vector{Float64}</code></p></li><li><p><code>dens_L::Vector{Float64}</code></p></li><li><p><code>dens_R::Vector{Float64}</code></p></li><li><p><code>mom_L::Vector{Float64}</code></p></li><li><p><code>mom_R::Vector{Float64}</code></p></li><li><p><code>flux_dens::Vector{Float64}</code></p></li><li><p><code>flux_mom::Vector{Float64}</code></p></li><li><p><code>wave_speed::Array{Float64, 0}</code>: Maximum wave speed for this species</p></li><li><p><code>max_timestep::Array{Float64, 0}</code>: Maximum permissable timestep for this species</p></li><li><p><code>species::HallThruster.Species</code>: The <code>Species</code> whose properties are stored in this struct</p></li><li><p><code>sound_speed::Float64</code>: The sound speed for this species</p></li><li><p><code>const_velocity::Float64</code>: For neutral species, the constant advection speed of this species</p></li><li><p><code>type::HallThruster.ConservationLawType</code>: The type of species (_ContinuityOnly or _IsothermalEuler)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/UM-PEPL/HallThruster.jl/blob/d4274a360605e435a04107a3a39aa881d1ef333a/src/physics/fluid.jl#L7">source</a></section></article><p>The <code>params</code> and <code>cache</code> objects are not as formalized as the <code>FluidContainer</code>. Broadly, the <code>cache</code> contains whatever state outside of the fluid containers is needed to reach a solution, including electron properties and temporary caches. This is allocated up front at the start of the simulation and reused throughout. The variables contained in the <code>cache</code> can be seen in the <code>allocate_arrays</code> function in <a href="https://github.com/UM-PEPL/HallThruster.jl/blob/main/src/simulation/allocation.jl"><code>allocation.jl</code></a>.</p><p>The <code>params</code> object contains the cache, all fluid containers, the simulation options, and all reactions. It copies a number of statically-typed parameters over from the <code>Config</code> struct to avoid type instabilities and reduce the precompilation burden that might be incurred if <code>Config</code> was passed to more places in the code. It stores the fluid containers in three ways. First, we have a single flat array (<code>params.fluid_arr</code>), which is useful when we need to iterate over all heavy species and do something, not caring about the specific type. Second, we have a NamedTuple with two keys: <code>continuity</code> for all neutral fluids and <code>isothermal</code> for ion fluids. This is useful for calculating fluxes, where we only care what the governing equations are but not what specific species are present. This is stored in <code>params.fluid_containers</code>. Finally, we have an array storing a similar struct for each species (<code>params.fluids_by_propellant</code>).</p><p>There are two places in which the contents of the <code>params</code> object are defined. The first is in the <code>params_from_config</code> function in <a href="https://github.com/UM-PEPL/HallThruster.jl/blob/main/src/simulation/configuration.jl"><code>configuration.jl</code></a>, and the second is in the <code>setup_simulation</code> function in <a href="https://github.com/UM-PEPL/HallThruster.jl/blob/main/src/simulation/simulation.jl"><code>simulation.jl</code></a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../collisions/">« Collisions and reactions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 15 October 2025 18:05">Wednesday 15 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
