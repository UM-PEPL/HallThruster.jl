<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Collisions and Reactions · HallThruster.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="HallThruster.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">HallThruster.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../physics/">Physics model</a></li><li><span class="tocitem">Configuration</span><ul><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li class="is-active"><a class="tocitem" href>Collisions and Reactions</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Ionization-models"><span>Ionization models</span></a></li><li><a class="tocitem" href="#Excitation-models"><span>Excitation models</span></a></li><li><a class="tocitem" href="#Electron-neutral-elastic-scattering-models"><span>Electron-neutral elastic scattering models</span></a></li><li><a class="tocitem" href="#Implementing-your-own-collisions"><span>Implementing your own collisions</span></a></li></ul></li><li><a class="tocitem" href="../anomalous_transport/">Anomalous Transport</a></li><li><a class="tocitem" href="../wall_loss_models/">Wall Loss Models</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../source_terms/">User-Provided Source Terms</a></li></ul></li><li><a class="tocitem" href="../verification/">Verification</a></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Configuration</a></li><li class="is-active"><a href>Collisions and Reactions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Collisions and Reactions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/UM-PEPL/HallThruster.jl/blob/master/docs/src/collisions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Collisions-and-Reactions"><a class="docs-heading-anchor" href="#Collisions-and-Reactions">Collisions and Reactions</a><a id="Collisions-and-Reactions-1"></a><a class="docs-heading-anchor-permalink" href="#Collisions-and-Reactions" title="Permalink"></a></h1><p>HallThruster.jl allows you to choose from a few different models for ionization, excitation and elastic scattering, or supply your own. This allows you to implement different propellants or more charge states for an existing propellant.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>All collisions and reactions in HallThruster.jl are handled via the <code>Reaction</code> interface. This is an abstract type with three subtypes: <code>IonizationReaction</code>, <code>ExcitationReaction</code>, and <code>ElasticScattering</code>.</p><p>The core of the ionization model in HallThruster.jl is the <code>IonizationReaction</code> struct. It has four fields: <code>energy</code>,  <code>reactant</code>, <code>product</code>, and <code>rate_coeff</code>. The first is of type <code>Float64</code> and is the ionization energy of the given reaction in eV. The next two are <code>Species</code> objects, while the last is an arbitrary function. This <code>rate_coeff</code> computes the ionization reaction rate coefficient (in m^3/s) provided the electron energy (in eV).  It is used in heavy species source terms in order to compute the production or destruction of the <code>reactant</code> and <code>product</code> due to ionization, and in the electron energy equation in order to compute electron energy losses due to inelastic ionization collisions.</p><p>Excitation reactions are handled similarly. The <code>ExcitationReaction</code> struct has only three fields: <code>energy</code>, <code>reactant</code> and <code>rate_coeff</code>, with the same types as above. Since fluids of different excitation levels are not tracked explicitly, the choice of excitation model only affects the electron energy balance.</p><p>Elastic scattering (electron-neutral) collisions are implemented via the <code>ElasticCollision</code> struct, which has two fields: <code>reactant</code> and <code>rate_coeff</code>, as no energy is lost in such collisions. This affects the electron momentum balance and the cross-field transport.</p><h2 id="Ionization-models"><a class="docs-heading-anchor" href="#Ionization-models">Ionization models</a><a id="Ionization-models-1"></a><a class="docs-heading-anchor-permalink" href="#Ionization-models" title="Permalink"></a></h2><p>HallThruster.jl provides two models out of the box. These are</p><table><tr><th style="text-align: right">Model</th><th style="text-align: right">Supported species</th><th style="text-align: right">Maximum charge state</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>IonizationLookup</code></td><td style="text-align: right"><code>Xenon</code>, <code>Krypton</code> (out of the box. With user-provided tables, can support any species)</td><td style="text-align: right"><code>3</code></td><td style="text-align: right">Ionization look-up table for species provided with HallThruster.jl. By default, the tables are stored in the <code>reactions</code> subfolder of the HallThruster.jl directory, but the user may provide additional directories in which to look for tables.</td></tr><tr><td style="text-align: right"><code>LandmarkIonizationLookup</code></td><td style="text-align: right"><code>Xenon</code></td><td style="text-align: right"><code>1</code></td><td style="text-align: right">Lookup table provided for the LANDMARK benchmark. Table is stored in the <code>landmark</code> subfolder of the HallThruster.jl directory.</td></tr></table><h3 id="IonizationLookup"><a class="docs-heading-anchor" href="#IonizationLookup"><code>IonizationLookup</code></a><a id="IonizationLookup-1"></a><a class="docs-heading-anchor-permalink" href="#IonizationLookup" title="Permalink"></a></h3><p>This is the default ionization model. To use the <code>IonizationLookup</code> model, initialize it as follows:</p><pre><code class="language-julia hljs">ionization_model = IonizationLookup([directories::Vector{AbstractString = String[]}])</code></pre><p>If the optional argument <code>directories</code> is left empty or unprovided, the HallThruster.jl will only look in the <code>reactions</code> subfolder of the HallThruster.jl main directory. Otherwise, HallThruster.jl will preferentially look in <code>directories</code> before before falling back to the included tables. If two files in user-provided directories have the same name, HallThruster.jl will pick the one in the directory which comes first in <code>directories</code>.</p><p>Inside of the folders listed in <code>directories</code>, HallThruster.jl will look for rate coefficient files matching the desired propellant gas and maximum charge state.  The rate coefficient files must be named as follows in order to be found.</p><p><code>ionization_$(reactant.symbol)_$(product.symbol).dat</code></p><p>For example, for a reaction file containing rate coefficients for direct double ionization of Bismuth, you would name the file <code>ionization_Bi_Bi2+.dat</code>, or for Argon II being ionized to Argon III, it would be <code>ionization_Ar2+_Ar3+.dat</code>.</p><p>The rate coefficient files must have the ionization energy in the first row, with a colon separating the descriptor and the number. It must next have a header row (which is skipped on load), followed by two tab-delimited columns. The first should have the electron energy (note: this is 3/2 Te) in eV, and the second should have the  rate coefficient in m^3/s. The first few rows of the <code>ionization_Kr_Kr+.dat</code> folder thus reads</p><pre><code class="nohighlight hljs">Ionization energy (eV): 13.9996055
Energy (eV) Rate coefficient (m3/s)
1.0 1.812780887933804e-23
2.0	6.784605416289418e-19
3.0	2.86241339516785e-17
4.0	2.0154931458303006e-16
5.0	6.77202352079487e-16
6.0	1.5567995341077301e-15
7.0	2.8667673314913722e-15
8.0	4.5818881444694e-15
9.0	6.650747725094247e-15</code></pre><h3 id="LandmarkIonizationLookup"><a class="docs-heading-anchor" href="#LandmarkIonizationLookup"><code>LandmarkIonizationLookup</code></a><a id="LandmarkIonizationLookup-1"></a><a class="docs-heading-anchor-permalink" href="#LandmarkIonizationLookup" title="Permalink"></a></h3><p>This accounts for single ionization of Xenon only using the lookup table provided by test case 3 of the <a href="https://www.landmark-plasma.com/test-case-3">LANDMARK benchmark</a>. It reads from the file <code>landmark/landmark_rates.csv</code>.  Useful mostly for replicating the LANDMARK benchmark.</p><h2 id="Excitation-models"><a class="docs-heading-anchor" href="#Excitation-models">Excitation models</a><a id="Excitation-models-1"></a><a class="docs-heading-anchor-permalink" href="#Excitation-models" title="Permalink"></a></h2><p>As with ionization, HallThruster.jl provides two models out of the box. These are</p><table><tr><th style="text-align: right">Model</th><th style="text-align: right">Supported species</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>ExcitationLookup</code></td><td style="text-align: right"><code>Xenon</code>, <code>Krypton</code> (out of the box. With user-provided tables, can support any species)</td><td style="text-align: right">Excitation look-up table for species provided with HallThruster.jl. By default, the tables are stored in the <code>reactions</code> subfolder of the HallThruster.jl directory, but the user may provide additional directories in which to look for tables.</td></tr><tr><td style="text-align: right"><code>LandmarkExcitationLookup</code></td><td style="text-align: right"><code>Xenon</code></td><td style="text-align: right">Lookup table provided for the LANDMARK benchmark. Table is stored in the <code>landmark</code> subfolder of the HallThruster.jl directory.</td></tr></table><h3 id="ExcitationLookup"><a class="docs-heading-anchor" href="#ExcitationLookup"><code>ExcitationLookup</code></a><a id="ExcitationLookup-1"></a><a class="docs-heading-anchor-permalink" href="#ExcitationLookup" title="Permalink"></a></h3><p>This is the default excitation model. To use the <code>ExcitationLookup</code> model, initialize it as follows:</p><pre><code class="language-julia hljs">excitation_model = ExcitationLookup([directories::Vector{AbstractString = String[]}])</code></pre><p>This functions nearly identically to the <code>IonizationLookup</code>, with the exception that, since excitation reactions do not change the charge state, the product is the same <code>Species</code> as the reactant and thus is not included in the filename. The filename for excitation reactions is thus:</p><p><code>excitation_$(reactant.symbol).dat</code></p><p>For example, for a reaction file containing excitation rate coefficients for neutral Argon would be called <code>excitation_Ar.dat</code>. Similarly, a file containing rates for excitation of triply-charged Xenon would be called <code>excitation_Xe3+.dat</code>.</p><p>The rate coefficient files are formatted identically to the ionization rate files. Below are the first few lines of the included <code>excitation_Xe.dat</code>.</p><pre><code class="nohighlight hljs">Excitation energy (eV): 8.32
Energy (eV)	Rate coefficient (m3/s)
1.0	2.909965013767145e-20
2.0	3.078734312855916e-17
3.0	4.1547515755380286e-16
4.0	1.6649256403317016e-15
5.0	3.9526948476759076e-15
6.0	7.124788357557455e-15
7.0	1.0908925177391674e-14
8.0	1.5042335588913955e-14
9.0	1.9316662863621785e-14</code></pre><h3 id="LandmarkIonizationLookup-2"><a class="docs-heading-anchor" href="#LandmarkIonizationLookup-2"><code>LandmarkIonizationLookup</code></a><a class="docs-heading-anchor-permalink" href="#LandmarkIonizationLookup-2" title="Permalink"></a></h3><p>This accounts for excitation of Xenon only using the lookup table provided by test case 3 of the <a href="https://www.landmark-plasma.com/test-case-3">LANDMARK benchmark</a>. It reads from the file <code>landmark/landmark_rates.csv</code>.  Useful mostly for replicating the LANDMARK benchmark. LANDMARK does explicitly provide excitation rates, and instead gives an energy loss coefficient. However, using the provided ionization rate coefficients, we can back out the excitation rate coefficients. These are then used to construct an <code>ExcitationReaction</code>.</p><h2 id="Electron-neutral-elastic-scattering-models"><a class="docs-heading-anchor" href="#Electron-neutral-elastic-scattering-models">Electron-neutral elastic scattering models</a><a id="Electron-neutral-elastic-scattering-models-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-neutral-elastic-scattering-models" title="Permalink"></a></h2><p>These are <code>ReactionModels</code> of type <code>ElectronNeutralModel</code>. HallThruster.jl provides three models out of the box. These are</p><table><tr><th style="text-align: right">Model</th><th style="text-align: right">Supported species</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right"><code>ElectronNeutralLookup</code></td><td style="text-align: right"><code>Xenon</code>, <code>Krypton</code> (out of the box. With user-provided tables, can support any species)</td><td style="text-align: right">Electron-neutral elastic scattering look-up table for species provided with HallThruster.jl. By default, the tables are stored in the <code>reactions</code> subfolder of the HallThruster.jl directory, but the user may provide additional directories in which to look for tables.</td></tr><tr><td style="text-align: right"><code>LandmarkElectronNeutral</code></td><td style="text-align: right"><code>Xenon</code></td><td style="text-align: right">Constant rate coefficient of <code>2.5e-13</code></td></tr><tr><td style="text-align: right"><code>GKElectronNeutral</code></td><td style="text-align: right"><code>Xenon</code></td><td style="text-align: right">Uses Eq. 36.13 on pg. 58 from Goebel and Katz to fit Xenon e-n cross section</td></tr></table><h2 id="Implementing-your-own-collisions"><a class="docs-heading-anchor" href="#Implementing-your-own-collisions">Implementing your own collisions</a><a id="Implementing-your-own-collisions-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-your-own-collisions" title="Permalink"></a></h2><p><code>ElectronNeutralModel</code>, <code>ExcitationModel</code> and <code>IonizationModel</code> are all subtypes of <code>ReactionModel</code>.  Users may specify their own <code>IonizationModel</code>, <code>ElectronNeutralModel</code>, or <code>ExcitationModel</code> by implementing a few key functions required by the <code>ReactionModel</code> interface. Let&#39;s say we wanted to implement our own ionization model, called <code>MyIonizationModel</code>, we would first define our struct as a subtype of <code>HallThruster.IonizationModel</code>, along with any fields we might want:</p><pre><code class="language-julia hljs">struct MyIonizationModel &lt;: HallThruster.IonizationModel
	# any fields you might want
end</code></pre><p>If we were defining an <code>ExcitationModel</code>, we would instead subtype <code>HallThruster.ExcitationModel</code>, and if we were defining a model for electron-neutral elastic scattering, we would subtype <code>ElectronNeutralModel</code>. Next, we need to define a few helper methods.</p><h3 id="supported_gases(::ReactionModel)::Vector{Gas}"><a class="docs-heading-anchor" href="#supported_gases(::ReactionModel)::Vector{Gas}"><code>supported_gases(::ReactionModel)::Vector{Gas}</code></a><a id="supported_gases(::ReactionModel)::Vector{Gas}-1"></a><a class="docs-heading-anchor-permalink" href="#supported_gases(::ReactionModel)::Vector{Gas}" title="Permalink"></a></h3><p>This method must return a vector of <code>Gas</code> objects. If not overwritten, this method returns <code>Gas[]</code>, which signifies that there are no restrictions on what type of gas works with this method. This is useful for <code>IonizationLookup</code>, which can in principle work for any gas, but not so much for <code>LandmarkLookup</code>, which is Xenon specific. Specifying which gases your model is valid for lets <code>HallThruster.jl</code> check at run time that user-provided propellant works with the provided model, preventing it from silently computing a bad result without the user&#39;s knowledge.</p><p>Let&#39;s say our model works exclusively with Bismuth</p><pre><code class="language-julia hljs">import HallThruster: supported_gases

HallThruster.supported_gases(::MyIonizationModel) = [HallThruster.Bismuth]</code></pre><h3 id="maximum_charge_state(::ReactionModel)::Int"><a class="docs-heading-anchor" href="#maximum_charge_state(::ReactionModel)::Int"><code>maximum_charge_state(::ReactionModel)::Int</code></a><a id="maximum_charge_state(::ReactionModel)::Int-1"></a><a class="docs-heading-anchor-permalink" href="#maximum_charge_state(::ReactionModel)::Int" title="Permalink"></a></h3><p>This method returns an integer corresponding to the maximum allowed charge state. By default, this is zero, indicating that our method can work with any charge state. However, to avoid mistakes down the line, it is best to define this, unless we&#39;re defining an <code>ElectronNeutralModel</code>. In our case, let&#39;s just work with singly-charged Bismuth.</p><pre><code class="language-julia hljs">import HallThruster: maximum_charge_state

maximum_charge_state(::MyIonizationModel) = 1</code></pre><h3 id="load_reactions(model::ReactionModel,-species::Vector{Species})"><a class="docs-heading-anchor" href="#load_reactions(model::ReactionModel,-species::Vector{Species})"><code>load_reactions(model::ReactionModel, species::Vector{Species})</code></a><a id="load_reactions(model::ReactionModel,-species::Vector{Species})-1"></a><a class="docs-heading-anchor-permalink" href="#load_reactions(model::ReactionModel,-species::Vector{Species})" title="Permalink"></a></h3><p>This is the most important method to define. <code>load_reactions</code> takes our model along with a vector of <code>Species</code> (generated using the <code>propellant</code> and <code>ncharge</code> fields in the user-provided <code>Config</code>) and returns a vector of <code>IonizationReaction{I}</code> or <code>ExcitationReaction{I}</code>, where <code>I</code> is the type of the rate coefficient function. It is important that the <code>Reactions</code> all have the same type so that the returned vector will have a concrete type, which will prevent dynamic dispatch during runtime and prevent unnecessary slowdowns. This means that if you have multiple reactions with different rate coefficient functions, you should use something like <a href="https://github.com/yuyichao/FunctionWrappers.jl"><code>FunctionWrappers.jl</code></a>.  Let&#39;s implement a simple ionization curve with the form</p><p class="math-container">\[k_{iz}(\epsilon) = 4\times 10^{-20} \exp\left(\frac{-7.3}{\frac{2}{3} \epsilon}\right)\sqrt{\frac{8 (\frac{2}{3}\epsilon)}{\pi m_e}}\]</p><p>We would implement this as so:</p><pre><code class="language-julia hljs">using FunctionWrappers
import HallThruster: e, me, load_reactions

kiz(ϵ) = 4e-20 * exp(-7.3 / (2/3 * ϵ)) * sqrt(8 * 2/3 * ϵ / pi / me)

function load_reactions(model::MyIonizationModel, species)
    rxn = IonizationReaction(
    	energy = -7.3,
        #=
        Since we defined maximum_charge_state and supported_species, we know that
        species[1] will be Bi and species[2] will be Bi+. Otherwise, an error would have
        been thrown before this point. Without these methods, we would need have logic 			 	handling whichever species get passed to the function.
        =#
        reactant = species[1],
        product = species[2],
        # Use a function wrapper here, though not necessary with only one reaction
        rate_coeff = FunctionWrapper{Float64, Tuple{Float64}}(kiz)
    )
    return rxn
end</code></pre><p>The above advice works identically for defining your own <code>ExcitationModel</code>, with the sole exception that <code>ExcitationReaction</code> objects do not have a <code>product</code> field. Similarly, we can define our own <code>ElectronNeutralModel</code>, noting that <code>ElasticCollision</code>s do not have an <code>energy</code> field or a <code>product</code> field. We would also not need to define <code>maximum_charge_state</code> for an <code>ElectronNeutralModel</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../initialization/">« Initialization</a><a class="docs-footer-nextpage" href="../anomalous_transport/">Anomalous Transport »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Tuesday 5 April 2022 20:18">Tuesday 5 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
