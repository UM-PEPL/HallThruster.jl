<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerics · HallThruster.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="HallThruster.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">HallThruster.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../run/">Tutorial</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../physics/">Physics model</a></li><li><span class="tocitem">Configuration</span><ul><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../propellants/">Propellants</a></li><li><a class="tocitem" href="../initialization/">Initialization</a></li><li><a class="tocitem" href="../thrusters/">Thrusters</a></li><li><a class="tocitem" href="../fluxes/">Fluxes</a></li><li><a class="tocitem" href="../collisions/">Collisions and Reactions</a></li><li><a class="tocitem" href="../anomalous_transport/">Anomalous Transport</a></li><li><a class="tocitem" href="../electron_thermal_conductivity/">Electron Thermal Conductivity</a></li><li><a class="tocitem" href="../wall_loss_models/">Wall Loss Models</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../source_terms/">User-Provided Source Terms</a></li></ul></li><li><a class="tocitem" href="../grid/">Grid generation</a></li><li class="is-active"><a class="tocitem" href>Numerics</a><ul class="internal"><li><a class="tocitem" href="#Spatial-discretization-for-heavy-species"><span>Spatial discretization for heavy species</span></a></li><li><a class="tocitem" href="#Time-discretization-of-heavy-species"><span>Time discretization of heavy species</span></a></li><li><a class="tocitem" href="#Electron-energy-equation-discretization"><span>Electron energy equation discretization</span></a></li><li><a class="tocitem" href="#Evaluation-of-derivatives"><span>Evaluation of derivatives</span></a></li></ul></li><li><a class="tocitem" href="../verification/">Verification</a></li><li><a class="tocitem" href="../internals/">Internals</a></li><li><a class="tocitem" href="../contribution/">Contribution</a></li><li><a class="tocitem" href="../citation/">Citation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Numerics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Numerics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/UM-PEPL/HallThruster.jl/blob/main/docs/src/numerics.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Numerics"><a class="docs-heading-anchor" href="#Numerics">Numerics</a><a id="Numerics-1"></a><a class="docs-heading-anchor-permalink" href="#Numerics" title="Permalink"></a></h1><p>As described in <a href="../config/#Configuration">Configuration</a> and <a href="../initialization/#Initialization">Initialization</a> different flux options are available in <code>HyperbolicScheme</code>. Timemarching for the heavy species is handled using a second order strong-stability preserving Runge-Kutta scheme (SSPRK22). The left hand side of the electron energy equation is integrated implicitly using a Crank Nicolson Adams Bashforth (CNAB) scheme. This enables larger timessteps due to the severe restrictions due to the electron heat flux.</p><h2 id="Spatial-discretization-for-heavy-species"><a class="docs-heading-anchor" href="#Spatial-discretization-for-heavy-species">Spatial discretization for heavy species</a><a id="Spatial-discretization-for-heavy-species-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-discretization-for-heavy-species" title="Permalink"></a></h2><p>Neutrals and ions are considered heavy species (compared to electrons). HallThruster.jl uses the finite volume method (FVM). FVM has the advantage that it is by definition conservative, which is a useful property when solving hyperbolic conservation laws such as the Euler equations. Currently, only the continuity equation is solved for the neutrals and the isothermal Euler equations for the ion species. Possibly, the full Euler equations will be added in the future, its implementation has been verified using the Sod Shock tube. The following provides and example of the control volume approach applied to the continuity equation.</p><p class="math-container">\[\int_{i-\frac{1}{2}}^{i+\frac{1}{2}} \frac{\partial n_n}{\partial t} \,dz + \int_{i-\frac{1}{2}}^{i+\frac{1}{2}} \frac{\partial n_n u_n}{\partial z} \,dz = \int_{i-\frac{1}{2}}^{i+\frac{1}{2}} \dot{n}_n \, dz\]</p><p>The <span>$n_n u_n$</span> can be replaced by a generic flux term <span>$F(z)$</span> and generalized to any advection like equation. Treatment of the source term is described in <a href="../collisions/#Collisions-and-Reactions">Collisions and Reactions</a>. Integration results in</p><p class="math-container">\[h\frac{\partial n_n}{\partial t} + \left(F_{_{i+\frac{1}{2}}} - F_{_{i-\frac{1}{2}}}\right) = h \dot{n}_n\]</p><p>See <a href="../fluxes/#Fluxes">Fluxes</a> for the implemented fluxes, and possible limiters to be used in reconstruction to ensure a total variation diminishing scheme (TVD).</p><h2 id="Time-discretization-of-heavy-species"><a class="docs-heading-anchor" href="#Time-discretization-of-heavy-species">Time discretization of heavy species</a><a id="Time-discretization-of-heavy-species-1"></a><a class="docs-heading-anchor-permalink" href="#Time-discretization-of-heavy-species" title="Permalink"></a></h2><p>We employ a strong stability preserving second-order Runge Kutta schemes (<code>SSPRK22</code>) for timestepping</p><p>The user has the option to supply a fixed timestep, or a CFL number. In the former case, the user will need to select a timestep that obeys the CFL condition, defined as</p><p class="math-container">\[    \sigma = \frac{u_i \Delta t}{\Delta x} &lt; 1\]</p><p>Using a maximum ion velocity of 22000 m/s, a domain length of 0.05m and 200 cells, results in <span>$\Delta t \leq 1.2 \times 10^{-8}$</span> s. In practice, it needs to be a bit lower in order to handle transients as the solution oscillates. This restriction is valid for the continuity and isothermal euler equations. Information on setting <code>dt</code> and selecting the integration scheme can be found in the <a href="@ref">Tutorial</a>.</p><p>In most cases, it is better to let HallThruster.jl handle timestepping automatically using its adaptive timestepping option. If adaptive timestepping is enabled, the user-defined timestep is ignored in favor of a timestep based on the minimum of three conditions and a user-supplied CFL number. Mathematically the timstep is choosen as:</p><p class="math-container">\[    \Delta t = min(\sigma \frac{\Delta x}{max(u_i + a_i, u_i - a_i)}, \sigma \frac{\dot{n}_i}{n_i}, \sqrt{\frac{\sigma m_i \Delta x}{q_i E}})\]</p><p>Where <span>$a_i$</span> is the ion sound speed. Physically, these three conditions represent timestep limits imposed by the flux, ionization, and electrostatic acceleration. Keep in mind that due to stability limits imposed by the ionization condition, the CFL number cannot be higher than 0.799 to remain stable. This limit will be imposed by HallThruster.jl if the user-defined value is too high.</p><h2 id="Electron-energy-equation-discretization"><a class="docs-heading-anchor" href="#Electron-energy-equation-discretization">Electron energy equation discretization</a><a id="Electron-energy-equation-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-energy-equation-discretization" title="Permalink"></a></h2><p>While the ions can be explicitly solved with <span>$\Delta t \sim 10^{-8}$</span>s, the heat condution term in the electron energy equation adds additional constraints which would lower the timestep by about a factor of 10. In order to not further increase the timestepping restrictions and increase computation time, the electron energy equation is solved semi-implicitly in time using a backward Euler or Crank-Nicholson scheme. See <a href="../config/#Configuration">Configuration</a> for information on how to select which scheme is used.</p><p>The spatial discretization of the electron energy equation uses central finite differences in a manner similar to the potential solver (see below). This, combined with the semi-implicit timestepping, creates a tridiagonal linear system which can be efficiently solved using the Thomas algorithm.</p><p>If adaptive timestepping is enabled, the timestep used for the explicit terms is limited by:</p><p class="math-container">\[    \Delta t = \abs{\frac{3\sigma n_eT_e}{W_{loss} + S_{coll}}}\]</p><p>As this timestep may be significantly smaller than the timestep used for the heavy species, the electron energy equation is updated using a series of sub-steps with the <span>$\Delta t$</span> enforced by the equation above until a total <span>$\Delta t$</span> equal to that set by the heavy species is reached.</p><h2 id="Evaluation-of-derivatives"><a class="docs-heading-anchor" href="#Evaluation-of-derivatives">Evaluation of derivatives</a><a id="Evaluation-of-derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluation-of-derivatives" title="Permalink"></a></h2><p>Some computations require the numerical approximation of derivatives, for example the evaluation of the electron velocity from the equation for electron current using the generalized Ohm&#39;s law, see <a href="../physics/#Physics-model">Physics model</a>. The derivatives are evaluated to second order using <a href="https://um-pepl.github.io/HallThruster.jl/dev/internals/#HallThruster.forward_difference-NTuple{6,%20Any}">forward difference</a>, <a href="https://um-pepl.github.io/HallThruster.jl/dev/internals/#HallThruster.central_difference-NTuple{6,%20Any}">central difference</a> or <a href="https://um-pepl.github.io/HallThruster.jl/dev/internals/#HallThruster.backward_difference-NTuple{6,%20Any}">backward difference</a> depending on the location in the domain.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../grid/">« Grid generation</a><a class="docs-footer-nextpage" href="../verification/">Verification »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 19 November 2024 17:08">Tuesday 19 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
